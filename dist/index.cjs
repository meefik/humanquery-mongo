"use strict";const t=[/('[^']*')/,/("[^"]*")/,/\(([^()]+)\)/,/([^&|]+>=[^&|]+)/,/([^&|]+>[^&|]+)/,/([^&|]+<=[^&|]+)/,/([^&|]+<[^&|]+)/,/([^&|]+!=[^&|]+)/,/([^&|]+=[^&|]+)/,/([^&|]+~\*[^&|]+)/,/([^&|]+~[^&|]+)/,/([^|]*[&][^|]*)/];function s(e,n={},r={}){if(r.c||(r.c=0),!r.p)do{r.p=Math.random().toString(16).slice(2)}while(e.indexOf(r.p)>-1);for(let c=0;c<t.length;c++){const o=t[c];for(;;){const t=e.match(o);if(!t)break;const l=`x${++r.c}_${r.p}`;e=e.replace(t[0],l);const i=t[0]!==t[1]?s(t[1],n,r):t[1];n[l]=c<2?i:i.replace(/\s/g,"")}}return e}function e(t,s={}){const n=s[t]||t;switch(!0){case/^null$/.test(n):return null;case/^now([+-]\d+([dhms])?)?$/.test(n):{const t=n.match(/^now([+-]\d+?([dhms])?)$/);if(t){const s=parseInt(t[1]||0,10),e=t[2]||"d",n=new Date,r={d:"Date",h:"Hours",m:"Minutes",s:"Seconds"};return n[`set${r[e]}`](n[`get${r[e]}`]()+s),n}return new Date}case/^'[^']*'$/.test(n):return n.split(/^'([^']*)'$/)[1]||"";case/^"[^"]*"$/.test(n):return n.split(/^"([^"]*)"$/)[1]||"";case/^\[[^[\]]*\]$/.test(n):{const t=[];if("[]"===n)return t;const r=n.slice(1,-1).split(/\s*,\s*/);for(let n=0;n<r.length;n++){const c=e(r[n],s);t.push(c)}return t}case/>=/.test(n):{const t=n.split(/\s*>=\s*/),r=e(t[0],s),c=e(t[1],s);return{[r]:{$gte:c}}}case/>/.test(n):{const t=n.split(/\s*>\s*/),r=e(t[0],s),c=e(t[1],s);return{[r]:{$gt:c}}}case/<=/.test(n):{const t=n.split(/\s*<=\s*/),r=e(t[0],s),c=e(t[1],s);return{[r]:{$lte:c}}}case/</.test(n):{const t=n.split(/\s*<\s*/),r=e(t[0],s),c=e(t[1],s);return{[r]:{$lt:c}}}case/!==/.test(n):{const t=n.split(/\s*!==\s*/),r=e(t[0],s);let c=e(t[1],s);return{[r]:{$ne:c}}}case/!=/.test(n):{const t=n.split(/\s*!=\s*/),r=e(t[0],s);let c=e(t[1],s);return{[r]:Array.isArray(c)&&c.length>0?{$nin:c}:{$ne:c}}}case/==/.test(n):{const t=n.split(/\s*==\s*/),r=e(t[0],s);let c=e(t[1],s);return{[r]:c}}case/=/.test(n):{const t=n.split(/\s*=\s*/),r=e(t[0],s);let c=e(t[1],s);return{[r]:Array.isArray(c)&&c.length>0?{$in:c}:c}}case/~\*/.test(n):{const t=n.split(/\s*~\*\s*/),r=e(t[0],s),c=e(t[1],s);return{[r]:{$regex:c,$options:"i"}}}case/~/.test(n):{const t=n.split(/\s*~\s*/),r=e(t[0],s),c=e(t[1],s);return{[r]:{$regex:c}}}case/&/.test(n):{const t=[],r=n.split(/\s*&\s*/);for(let n=0;n<r.length;n++){const c=e(r[n],s);"object"==typeof c&&null!==c&&t.push(c)}return{$and:t}}case/\|/.test(n):{const t=[],r=n.split(/\s*\|\s*/);for(let n=0;n<r.length;n++){const c=e(r[n],s);"object"==typeof c&&null!==c&&t.push(c)}return{$or:t}}default:{let t=n;for(;s[t];)t=e(s[t],s);if(t&&"string"==typeof t){if("true"===t.toLowerCase())return!0;if("false"===t.toLowerCase())return!1;if(!isNaN(t))return+t;if(/^\d{4}-\d{2}-\d{2}(T\d{2}:\d{2}:\d{2}(.\d{3}Z?)?)?$/.test(t)){const s=new Date(t);if(!isNaN(s))return s}}return t||null}}}module.exports=function(t){if(!t||"string"!=typeof t)return null;const n={};return e(s(t,n),n)};
